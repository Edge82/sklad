import{d as j,c as $,o as x,e as a,g as se,h as M,i as I,P as oe,j as le,J as E,w as l,a as t,u as e,l as V,p as w,q as G,b as s,y as U,v as T,s as H,Q as re,H as ae,I as ne,R as K,k,t as f,B as P,z as Q,n as N,m as _,S as ie,T as de,O as A,U as me,V as pe,D as ce,X as fe,G as ve,M as W,K as ee,N as ye,Y as te,r as ge,Z as we,E as be,F as b,_ as he,$ as Y}from"./index-DC4ENTic.js";import{A as J}from"./AddCircleOutline-C7MbpqnR.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{T as ue}from"./TimeOutline-COE-oNgJ.js";import{C as ke}from"./CheckmarkCircleOutline-B_HM8-Ck.js";import{C as Ne,S as xe,E as Oe,P as De,T as Pe}from"./TrashOutline-BEbQvfq4.js";const Ue={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},_e=j({name:"CreateOutline",render:function(v,y){return x(),$("svg",Ue,y[0]||(y[0]=[a("path",{d:"M384 224v184a40 40 0 0 1-40 40H104a40 40 0 0 1-40-40V168a40 40 0 0 1 40-40h167.48",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),a("path",{d:"M459.94 53.25a16.06 16.06 0 0 0-23.22-.56L424.35 65a8 8 0 0 0 0 11.31l11.34 11.32a8 8 0 0 0 11.34 0l12.06-12c6.1-6.09 6.67-16.01.85-22.38z",fill:"currentColor"},null,-1),a("path",{d:"M399.34 90L218.82 270.2a9 9 0 0 0-2.31 3.93L208.16 299a3.91 3.91 0 0 0 4.86 4.86l24.85-8.35a9 9 0 0 0 3.93-2.31L422 112.66a9 9 0 0 0 0-12.66l-9.95-10a9 9 0 0 0-12.71 0z",fill:"currentColor"},null,-1)]))}}),Ce={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},qe=j({name:"PrintOutline",render:function(v,y){return x(),$("svg",Ce,y[0]||(y[0]=[a("path",{d:"M384 368h24a40.12 40.12 0 0 0 40-40V168a40.12 40.12 0 0 0-40-40H104a40.12 40.12 0 0 0-40 40v160a40.12 40.12 0 0 0 40 40h24",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),a("rect",{x:"128",y:"240",width:"256",height:"208",rx:"24.32",ry:"24.32",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),a("path",{d:"M384 128v-24a40.12 40.12 0 0 0-40-40H168a40.12 40.12 0 0 0-40 40v24",fill:"none",stroke:"currentColor","stroke-linejoin":"round","stroke-width":"32"},null,-1),a("circle",{cx:"392",cy:"184",r:"24",fill:"currentColor"},null,-1)]))}}),$e={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},Ie=j({name:"SyncOutline",render:function(v,y){return x(),$("svg",$e,y[0]||(y[0]=[a("path",{d:"M434.67 285.59v-29.8c0-98.73-80.24-178.79-179.2-178.79a179 179 0 0 0-140.14 67.36m-38.53 82v29.8C76.8 355 157 435 256 435a180.45 180.45 0 0 0 140-66.92",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),a("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M32 256l44-44l46 44"},null,-1),a("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M480 256l-44 44l-46-44"},null,-1)]))}}),Se=se("orders",()=>{const i=M([{id:1,orderNumber:"ORD-2024-001",customerName:"Иван Иванов",customerPhone:"+7 (999) 123-45-67",customerEmail:"ivan@example.com",status:"processing",priority:"high",orderDate:new Date("2024-01-15"),deadline:new Date("2024-02-01"),totalAmount:45e3,items:[{id:1,orderId:1,itemId:1,itemName:'Кухонный гарнитур "Модерн"',quantity:1,unitPrice:45e3,totalPrice:45e3,materialUsed:"Дуб, МДФ"}],notes:"Срочный заказ, клиент ждет",createdBy:"Иван Петров",lastUpdated:new Date("2024-01-16")},{id:2,orderNumber:"ORD-2024-002",customerName:'ООО "МебельПро"',customerPhone:"+7 (999) 987-65-43",customerEmail:"order@mebelpro.ru",status:"ready",priority:"medium",orderDate:new Date("2024-01-10"),deadline:new Date("2024-01-25"),totalAmount:12e4,items:[{id:2,orderId:2,itemId:2,itemName:"Офисные столы",quantity:5,unitPrice:15e3,totalPrice:75e3,materialUsed:"Стекло, металл"},{id:3,orderId:2,itemId:3,itemName:"Офисные стулья",quantity:10,unitPrice:4500,totalPrice:45e3,materialUsed:"Ткань, металл"}],notes:"Корпоративный заказ",createdBy:"Мария Сидорова",lastUpdated:new Date("2024-01-14")},{id:3,orderNumber:"ORD-2024-003",customerName:"Петр Сидоров",customerPhone:"+7 (999) 555-44-33",customerEmail:"petr@example.com",status:"new",priority:"low",orderDate:new Date("2024-01-20"),deadline:new Date("2024-02-15"),totalAmount:28e3,items:[{id:4,orderId:3,itemId:4,itemName:'Прихожая "Классик"',quantity:1,unitPrice:28e3,totalPrice:28e3,materialUsed:"Сосна, ДСП"}],createdBy:"Иван Петров",lastUpdated:new Date("2024-01-20")},{id:4,orderNumber:"ORD-2024-004",customerName:"Анна Ковалева",customerPhone:"+7 (999) 777-88-99",customerEmail:"anna@example.com",status:"completed",priority:"medium",orderDate:new Date("2024-01-05"),deadline:new Date("2024-01-20"),totalAmount:65e3,items:[{id:5,orderId:4,itemId:5,itemName:'Спальня "Элегант"',quantity:1,unitPrice:65e3,totalPrice:65e3,materialUsed:"Бук, МДФ"}],notes:"Заказ выполнен досрочно",createdBy:"Сергей Волков",lastUpdated:new Date("2024-01-18")},{id:5,orderNumber:"ORD-2024-005",customerName:'Кафе "Уют"',customerPhone:"+7 (999) 222-33-44",customerEmail:"cafe@uyut.ru",status:"shipped",priority:"urgent",orderDate:new Date("2024-01-18"),deadline:new Date("2024-01-25"),totalAmount:89e3,items:[{id:6,orderId:5,itemId:6,itemName:"Барные стойки",quantity:2,unitPrice:35e3,totalPrice:7e4,materialUsed:"Дуб, камень"},{id:7,orderId:5,itemId:7,itemName:"Барные стулья",quantity:8,unitPrice:2375,totalPrice:19e3,materialUsed:"Металл, кожа"}],notes:"Срочно для открытия",createdBy:"Иван Петров",lastUpdated:new Date("2024-01-22")}]),v=[{label:"Новый",value:"new",color:"default"},{label:"В обработке",value:"processing",color:"warning"},{label:"Готов",value:"ready",color:"info"},{label:"Отправлен",value:"shipped",color:"primary"},{label:"Завершен",value:"completed",color:"success"},{label:"Отменен",value:"cancelled",color:"error"}],y=[{label:"Низкий",value:"low",color:"success"},{label:"Средний",value:"medium",color:"warning"},{label:"Высокий",value:"high",color:"error"},{label:"Срочный",value:"urgent",color:"error"}],C=I(()=>i.value.length),q=I(()=>i.value.filter(p=>p.status==="new"||p.status==="processing").length),O=I(()=>i.value.filter(p=>p.status==="completed").length),o=I(()=>i.value.reduce((p,m)=>p+m.totalAmount,0)),S=I(()=>[...i.value].sort((p,m)=>m.orderDate.getTime()-p.orderDate.getTime()).slice(0,5));return{orders:i,statusOptions:v,priorityOptions:y,totalOrders:C,pendingOrders:q,completedOrders:O,totalRevenue:o,recentOrders:S,getOrderById:p=>i.value.find(m=>m.id===p),getOrdersByStatus:p=>i.value.filter(m=>m.status===p),addOrder:p=>{const m={...p,id:i.value.length+1,orderNumber:`ORD-${new Date().getFullYear()}-${String(i.value.length+1).padStart(3,"0")}`,lastUpdated:new Date};return i.value.unshift(m),m},updateOrderStatus:(p,m)=>{const u=i.value.find(c=>c.id===p);u&&(u.status=m,u.lastUpdated=new Date)},deleteOrder:p=>{const m=i.value.findIndex(u=>u.id===p);m!==-1&&i.value.splice(m,1)},getStatusLabel:p=>{const m=v.find(u=>u.value===p);return m?m.label:p},getPriorityLabel:p=>{const m=y.find(u=>u.value===p);return m?m.label:p}}}),Be={class:"flex justify-between items-center mb-3"},Re={class:"flex justify-between items-center"},Te={class:"flex justify-end gap-3 mt-6"},Me=j({__name:"OrderForm",emits:["submit","cancel"],setup(i,{emit:v}){const y=v,C=oe(),q=M(null),O=M(!1),o=le({customerName:"",customerPhone:"",customerEmail:"",status:"new",priority:"medium",orderDate:new Date,deadline:new Date(Date.now()+336*60*60*1e3),items:[{itemName:"",quantity:1,unitPrice:0,materialUsed:""}],notes:""}),S=[{label:"Новый",value:"new"},{label:"В обработке",value:"processing"},{label:"Готов",value:"ready"},{label:"Отправлен",value:"shipped"},{label:"Завершен",value:"completed"},{label:"Отменен",value:"cancelled"}],F=[{label:"Низкий",value:"low"},{label:"Средний",value:"medium"},{label:"Высокий",value:"high"},{label:"Срочный",value:"urgent"}],B=I(()=>o.items.reduce((m,u)=>m+u.quantity*u.unitPrice,0)),L={customerName:[{required:!0,message:"Введите ФИО клиента",trigger:"blur"},{min:2,message:"Имя должно быть не менее 2 символов",trigger:"blur"}],customerPhone:[{required:!0,message:"Введите телефон",trigger:"blur"},{pattern:/^[\d\s()+-\/]+$/,message:"Некорректный номер телефона",trigger:"blur"}],customerEmail:[{type:"email",message:"Некорректный email",trigger:"blur"}],priority:[{required:!0,message:"Выберите приоритет",trigger:"change"}],deadline:[{required:!0,message:"Выберите срок выполнения",trigger:"change"}],"items[0].itemName":[{required:!0,message:"Введите наименование товара",trigger:"blur"}],"items[0].quantity":[{required:!0,type:"number",min:1,message:"Количество должно быть не менее 1",trigger:"blur"}],"items[0].unitPrice":[{required:!0,type:"number",min:0,message:"Цена должна быть положительной",trigger:"blur"}]},z=m=>m<Date.now()-1440*60*1e3,R=m=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:0}).format(m),g=()=>{o.items.push({itemName:"",quantity:1,unitPrice:0,materialUsed:""})},d=m=>{o.items.splice(m,1)},p=()=>{q.value?.validate(m=>{if(m)window.$message?.error("Пожалуйста, исправьте ошибки в форме");else{O.value=!0;const u={...o,totalAmount:B.value,items:o.items.map((c,n)=>({...c,totalPrice:c.quantity*c.unitPrice})),createdBy:C.user?.name||"Система"};setTimeout(()=>{y("submit",u),O.value=!1},1e3)}})};return(m,u)=>(x(),E(e(ie),{ref_key:"formRef",ref:q,model:o,rules:L,"label-placement":"top"},{default:l(()=>[t(e(V),{cols:2,"x-gap":24},{default:l(()=>[t(e(w),null,{default:l(()=>[t(e(G),null,{default:l(()=>[...u[8]||(u[8]=[s("Информация о клиенте",-1)])]),_:1}),t(e(U),{label:"ФИО клиента",path:"customerName",required:""},{default:l(()=>[t(e(T),{value:o.customerName,"onUpdate:value":u[0]||(u[0]=c=>o.customerName=c),placeholder:"Введите ФИО клиента"},null,8,["value"])]),_:1}),t(e(U),{label:"Телефон",path:"customerPhone",required:""},{default:l(()=>[t(e(T),{value:o.customerPhone,"onUpdate:value":u[1]||(u[1]=c=>o.customerPhone=c),placeholder:"+7 (999) 999-99-99"},null,8,["value"])]),_:1}),t(e(U),{label:"Email",path:"customerEmail"},{default:l(()=>[t(e(T),{value:o.customerEmail,"onUpdate:value":u[2]||(u[2]=c=>o.customerEmail=c),placeholder:"email@example.com",type:"email"},null,8,["value"])]),_:1})]),_:1}),t(e(w),null,{default:l(()=>[t(e(G),null,{default:l(()=>[...u[9]||(u[9]=[s("Детали заказа",-1)])]),_:1}),t(e(U),{label:"Приоритет",path:"priority",required:""},{default:l(()=>[t(e(H),{value:o.priority,"onUpdate:value":u[3]||(u[3]=c=>o.priority=c),options:F,placeholder:"Выберите приоритет"},null,8,["value"])]),_:1}),t(e(U),{label:"Срок выполнения",path:"deadline",required:""},{default:l(()=>[t(e(re),{value:o.deadline,"onUpdate:value":u[4]||(u[4]=c=>o.deadline=c),type:"date","is-date-disabled":z,placeholder:"Выберите дату",style:{width:"100%"}},null,8,["value"])]),_:1}),t(e(U),{label:"Статус",path:"status",required:""},{default:l(()=>[t(e(H),{value:o.status,"onUpdate:value":u[5]||(u[5]=c=>o.status=c),options:S,placeholder:"Выберите статус"},null,8,["value"])]),_:1})]),_:1}),t(e(w),{span:2},{default:l(()=>[t(e(G),null,{default:l(()=>[...u[10]||(u[10]=[s("Позиции заказа",-1)])]),_:1}),(x(!0),$(ae,null,ne(o.items,(c,n)=>(x(),$("div",{key:n,class:"order-item mb-4 p-4 border rounded"},[a("div",Be,[t(e(k),{strong:""},{default:l(()=>[s("Позиция "+f(n+1),1)]),_:2},1024),o.items.length>1?(x(),E(e(P),{key:0,size:"small",type:"error",quaternary:"",onClick:r=>d(n)},{default:l(()=>[...u[11]||(u[11]=[s(" Удалить ",-1)])]),_:1},8,["onClick"])):K("",!0)]),t(e(V),{cols:3,"x-gap":12},{default:l(()=>[t(e(w),null,{default:l(()=>[t(e(U),{label:"Наименование",path:`items[${n}].itemName`,required:""},{default:l(()=>[t(e(T),{value:c.itemName,"onUpdate:value":r=>c.itemName=r,placeholder:"Наименование товара"},null,8,["value","onUpdate:value"])]),_:2},1032,["path"])]),_:2},1024),t(e(w),null,{default:l(()=>[t(e(U),{label:"Количество",path:`items[${n}].quantity`,required:""},{default:l(()=>[t(e(Q),{value:c.quantity,"onUpdate:value":r=>c.quantity=r,min:1,precision:0,placeholder:"Количество",style:{width:"100%"}},null,8,["value","onUpdate:value"])]),_:2},1032,["path"])]),_:2},1024),t(e(w),null,{default:l(()=>[t(e(U),{label:"Цена за единицу",path:`items[${n}].unitPrice`,required:""},{default:l(()=>[t(e(Q),{value:c.unitPrice,"onUpdate:value":r=>c.unitPrice=r,min:0,precision:2,placeholder:"Цена",style:{width:"100%"}},{suffix:l(()=>[...u[12]||(u[12]=[s("₽",-1)])]),_:1},8,["value","onUpdate:value"])]),_:2},1032,["path"])]),_:2},1024),t(e(w),{span:2},{default:l(()=>[t(e(U),{label:"Материалы",path:`items[${n}].materialUsed`},{default:l(()=>[t(e(T),{value:c.materialUsed,"onUpdate:value":r=>c.materialUsed=r,placeholder:"Используемые материалы"},null,8,["value","onUpdate:value"])]),_:2},1032,["path"])]),_:2},1024),t(e(w),null,{default:l(()=>[t(e(U),{label:"Итого",path:`items[${n}].totalPrice`},{default:l(()=>[t(e(Q),{value:c.quantity*c.unitPrice,disabled:"",style:{width:"100%"}},{suffix:l(()=>[...u[13]||(u[13]=[s("₽",-1)])]),_:1},8,["value"])]),_:2},1032,["path"])]),_:2},1024)]),_:2},1024)]))),128)),t(e(P),{onClick:g,type:"primary",quaternary:"",class:"mb-4"},{icon:l(()=>[t(e(N),null,{default:l(()=>[t(e(J))]),_:1})]),default:l(()=>[u[14]||(u[14]=s(" Добавить позицию ",-1))]),_:1})]),_:1}),t(e(w),{span:2},{default:l(()=>[t(e(U),{label:"Примечания",path:"notes"},{default:l(()=>[t(e(T),{value:o.notes,"onUpdate:value":u[6]||(u[6]=c=>o.notes=c),type:"textarea",rows:3,placeholder:"Дополнительная информация о заказе"},null,8,["value"])]),_:1})]),_:1}),t(e(w),{span:2},{default:l(()=>[t(e(_),null,{default:l(()=>[a("div",Re,[t(e(k),{strong:""},{default:l(()=>[...u[15]||(u[15]=[s("Итоговая сумма заказа:",-1)])]),_:1}),t(e(k),{strong:"",size:"large",type:"primary"},{default:l(()=>[s(f(R(B.value)),1)]),_:1})])]),_:1})]),_:1})]),_:1}),a("div",Te,[t(e(P),{onClick:u[7]||(u[7]=c=>m.$emit("cancel"))},{default:l(()=>[...u[16]||(u[16]=[s("Отмена",-1)])]),_:1}),t(e(P),{type:"primary",onClick:p,loading:O.value},{default:l(()=>[...u[17]||(u[17]=[s(" Создать заказ ",-1)])]),_:1},8,["loading"])])]),_:1},8,["model"]))}}),Fe=X(Me,[["__scopeId","data-v-3d4691f7"]]),Le={key:0,class:"order-details"},ze={class:"mb-6"},Ee={class:"flex justify-between items-start mb-4"},je={class:"text-right"},Ae={class:"mt-2"},Ve={class:"font-bold text-lg"},He={key:1,class:"text-center py-8"},Ge=j({__name:"OrderDetails",props:{order:{}},setup(i){const v=i,y=I(()=>new Date(v.order.deadline)<new Date&&v.order.status!=="completed"),C=g=>new Intl.DateTimeFormat("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric"}).format(g),q=g=>new Intl.DateTimeFormat("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(g),O=g=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:0}).format(g),o=g=>({new:"Новый",processing:"В обработке",ready:"Готов",shipped:"Отправлен",completed:"Завершен",cancelled:"Отменен"})[g]||g,S=g=>({new:"default",processing:"warning",ready:"info",shipped:"primary",completed:"success",cancelled:"error"})[g]||"default",F=g=>({low:"Низкий",medium:"Средний",high:"Высокий",urgent:"Срочный"})[g]||g,B=g=>({low:"success",medium:"warning",high:"error",urgent:"error"})[g]||"default",L=()=>{window.$message?.info("Печать заказа")},z=()=>{window.$message?.info("Изменение статуса")},R=()=>{window.$message?.success("Уведомление отправлено клиенту")};return(g,d)=>i.order?(x(),$("div",Le,[a("div",ze,[a("div",Ee,[a("div",null,[t(e(de),{class:"m-0"},{default:l(()=>[s(f(i.order.orderNumber),1)]),_:1}),t(e(k),{depth:"3"},{default:l(()=>[s("Заказ от "+f(C(i.order.orderDate)),1)]),_:1})]),a("div",je,[t(e(A),{type:S(i.order.status),size:"large"},{default:l(()=>[s(f(o(i.order.status)),1)]),_:1},8,["type"]),a("div",Ae,[t(e(A),{type:B(i.order.priority)},{default:l(()=>[s(f(F(i.order.priority)),1)]),_:1},8,["type"])])])])]),t(e(_),{title:"Информация о клиенте",class:"mb-4"},{default:l(()=>[t(e(V),{cols:3,"y-gap":12},{default:l(()=>[t(e(w),null,{default:l(()=>[a("div",null,[t(e(k),{strong:""},{default:l(()=>[...d[0]||(d[0]=[s("ФИО:",-1)])]),_:1}),a("p",null,f(i.order.customerName),1)])]),_:1}),t(e(w),null,{default:l(()=>[a("div",null,[t(e(k),{strong:""},{default:l(()=>[...d[1]||(d[1]=[s("Телефон:",-1)])]),_:1}),a("p",null,f(i.order.customerPhone),1)])]),_:1}),t(e(w),null,{default:l(()=>[a("div",null,[t(e(k),{strong:""},{default:l(()=>[...d[2]||(d[2]=[s("Email:",-1)])]),_:1}),a("p",null,f(i.order.customerEmail),1)])]),_:1}),t(e(w),null,{default:l(()=>[a("div",null,[t(e(k),{strong:""},{default:l(()=>[...d[3]||(d[3]=[s("Создал:",-1)])]),_:1}),a("p",null,f(i.order.createdBy),1)])]),_:1}),t(e(w),null,{default:l(()=>[a("div",null,[t(e(k),{strong:""},{default:l(()=>[...d[4]||(d[4]=[s("Дата заказа:",-1)])]),_:1}),a("p",null,f(C(i.order.orderDate)),1)])]),_:1}),t(e(w),null,{default:l(()=>[a("div",null,[t(e(k),{strong:""},{default:l(()=>[...d[5]||(d[5]=[s("Срок выполнения:",-1)])]),_:1}),a("p",{class:me(y.value?"text-red-500 font-medium":"")},[s(f(C(i.order.deadline))+" ",1),y.value?(x(),E(e(A),{key:0,size:"small",type:"error"},{default:l(()=>[...d[6]||(d[6]=[s("Просрочен",-1)])]),_:1})):K("",!0)],2)])]),_:1})]),_:1})]),_:1}),t(e(_),{title:"Позиции заказа",class:"mb-4"},{default:l(()=>[t(e(pe),{striped:""},{default:l(()=>[d[8]||(d[8]=a("thead",null,[a("tr",null,[a("th",null,"№"),a("th",null,"Наименование"),a("th",null,"Количество"),a("th",null,"Цена за ед."),a("th",null,"Материалы"),a("th",null,"Сумма")])],-1)),a("tbody",null,[(x(!0),$(ae,null,ne(i.order.items,(p,m)=>(x(),$("tr",{key:p.id},[a("td",null,f(m+1),1),a("td",null,f(p.itemName),1),a("td",null,f(p.quantity),1),a("td",null,f(O(p.unitPrice)),1),a("td",null,f(p.materialUsed||"-"),1),a("td",null,f(O(p.totalPrice)),1)]))),128))]),a("tfoot",null,[a("tr",null,[d[7]||(d[7]=a("td",{colspan:"5",class:"text-right font-bold"},"Итого:",-1)),a("td",Ve,f(O(i.order.totalAmount)),1)])])]),_:1})]),_:1}),t(e(V),{cols:2,"x-gap":16},{default:l(()=>[t(e(w),null,{default:l(()=>[t(e(_),{title:"Примечания"},{default:l(()=>[i.order.notes?(x(),E(e(k),{key:0},{default:l(()=>[s(f(i.order.notes),1)]),_:1})):(x(),E(e(k),{key:1,depth:"3"},{default:l(()=>[...d[9]||(d[9]=[s("Нет примечаний",-1)])]),_:1}))]),_:1})]),_:1}),t(e(w),null,{default:l(()=>[t(e(_),{title:"Действия"},{default:l(()=>[t(e(ce),{vertical:""},{default:l(()=>[t(e(P),{block:"",onClick:L,type:"primary"},{icon:l(()=>[t(e(N),null,{default:l(()=>[t(e(qe))]),_:1})]),default:l(()=>[d[10]||(d[10]=s(" Печать заказа ",-1))]),_:1}),t(e(P),{block:"",onClick:z,type:"warning"},{icon:l(()=>[t(e(N),null,{default:l(()=>[t(e(Ie))]),_:1})]),default:l(()=>[d[11]||(d[11]=s(" Изменить статус ",-1))]),_:1}),t(e(P),{block:"",onClick:R,type:"info"},{icon:l(()=>[t(e(N),null,{default:l(()=>[t(e(fe))]),_:1})]),default:l(()=>[d[12]||(d[12]=s(" Уведомить клиента ",-1))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(e(_),{title:"История изменений",class:"mt-4"},{default:l(()=>[t(e(ve),null,{default:l(()=>[t(e(W),null,{prefix:l(()=>[t(e(N),null,{default:l(()=>[t(e(_e))]),_:1})]),default:l(()=>[t(e(ee),{title:"Заказ создан",description:q(i.order.orderDate)},{description:l(()=>[s(f(i.order.createdBy),1)]),_:1},8,["description"])]),_:1}),t(e(W),null,{prefix:l(()=>[t(e(N),null,{default:l(()=>[t(e(ue))]),_:1})]),default:l(()=>[t(e(ee),{title:"Последнее обновление",description:q(i.order.lastUpdated)},{description:l(()=>[s(" Статус: "+f(o(i.order.status)),1)]),_:1},8,["description"])]),_:1})]),_:1})]),_:1})])):(x(),$("div",He,[t(e(k),{depth:"3"},{default:l(()=>[...d[13]||(d[13]=[s("Заказ не найден",-1)])]),_:1})]))}}),Qe=X(Ge,[["__scopeId","data-v-53d2e951"]]),Ye={class:"orders-page"},Je={class:"flex justify-between items-center mb-6"},Ke={style:{gap:"8px",display:"flex",margin:"8px"}},Xe={class:"flex justify-between items-center"},Ze={class:"flex justify-between items-center"},We={class:"flex justify-between items-center"},et={class:"flex justify-between items-center"},tt={class:"flex flex-wrap gap-4"},lt=j({__name:"Orders",setup(i){const v=Se(),y=M(!1),C=M(!1),q=M(null),O=M(""),o=le({status:null,priority:null,dateRange:null}),S=[{label:"Новый",value:"new"},{label:"В обработке",value:"processing"},{label:"Готов",value:"ready"},{label:"Отправлен",value:"shipped"},{label:"Завершен",value:"completed"},{label:"Отменен",value:"cancelled"}],F=[{label:"Низкий",value:"low"},{label:"Средний",value:"medium"},{label:"Высокий",value:"high"},{label:"Срочный",value:"urgent"}],B={pageSize:10},L=I(()=>{let n=v.orders;if(O.value){const r=O.value.toLowerCase();n=n.filter(D=>D.customerName.toLowerCase().includes(r)||D.orderNumber.toLowerCase().includes(r)||D.customerPhone.includes(r)||D.customerEmail.toLowerCase().includes(r))}if(o.status&&(n=n.filter(r=>r.status===o.status)),o.priority&&(n=n.filter(r=>r.priority===o.priority)),o.dateRange){const[r,D]=o.dateRange;n=n.filter(h=>{const Z=h.orderDate.getTime();return Z>=r&&Z<=D})}return n}),z=[{title:"Номер",key:"orderNumber",width:150,render:n=>b("span",{class:"font-mono"},n.orderNumber)},{title:"Клиент",key:"customerName",render:n=>b("div",[b("div",{class:"font-medium"},n.customerName),b("div",{class:"text-xs text-gray-500"},n.customerPhone)])},{title:"Дата заказа",key:"orderDate",width:150,render:n=>R(n.orderDate)},{title:"Срок",key:"deadline",width:150,render:n=>{const r=new Date(n.deadline)<new Date&&n.status!=="completed";return b("div",{class:r?"text-red-500 font-medium":""},[R(n.deadline),r?b(he,{dot:!0,type:"error",class:"ml-2"}):null])}},{title:"Статус",key:"status",width:150,render:n=>{const r=v.statusOptions.find(D=>D.value===n.status);return b(A,{type:r?.color,size:"small"},{default:()=>v.getStatusLabel(n.status)})}},{title:"Приоритет",key:"priority",width:120,render:n=>{const r=v.priorityOptions.find(D=>D.value===n.priority);return b(A,{type:r?.color,size:"small"},{default:()=>v.getPriorityLabel(n.priority)})}},{title:"Сумма",key:"totalAmount",width:120,render:n=>g(n.totalAmount)},{title:"Действия",key:"actions",width:150,render:n=>b("div",{class:"flex gap-2"},[b(Y,null,{trigger:()=>b(P,{size:"small",type:"info",quaternary:!0,onClick:()=>p(n.id)},{icon:()=>b(N,null,{default:()=>b(Oe)})}),default:()=>"Просмотр"}),b(Y,null,{trigger:()=>b(P,{size:"small",type:"warning",quaternary:!0,onClick:()=>m(n.id)},{icon:()=>b(N,null,{default:()=>b(De)})}),default:()=>"Редактировать"}),b(Y,null,{trigger:()=>b(P,{size:"small",type:"error",quaternary:!0,onClick:()=>u(n.id)},{icon:()=>b(N,null,{default:()=>b(Pe)})}),default:()=>"Удалить"})])}],R=n=>new Intl.DateTimeFormat("ru-RU").format(n),g=n=>new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB",minimumFractionDigits:0}).format(n),d=()=>{O.value="",o.status=null,o.priority=null,o.dateRange=null},p=n=>{q.value=v.getOrderById(n),C.value=!0},m=n=>{window.$message?.info("Редактирование заказа")},u=n=>{window.$dialog&&window.$dialog.warning({title:"Удаление заказа",content:"Вы уверены, что хотите удалить этот заказ?",positiveText:"Удалить",negativeText:"Отмена",onPositiveClick:()=>{v.deleteOrder(n),window.$message?.success("Заказ удален")}})},c=n=>{v.addOrder(n),y.value=!1,window.$message?.success("Заказ успешно создан")};return(n,r)=>{const D=ge("n-h3");return x(),$("div",Ye,[a("div",Je,[a("div",null,[t(e(ye),null,{default:l(()=>[...r[9]||(r[9]=[s("Заказы",-1)])]),_:1}),t(e(k),{depth:"3"},{default:l(()=>[...r[10]||(r[10]=[s("Управление заказами клиентов",-1)])]),_:1})]),a("div",Ke,[t(e(P),{type:"primary",onClick:r[0]||(r[0]=h=>y.value=!0),class:"mr-4"},{icon:l(()=>[t(e(N),null,{default:l(()=>[t(e(J))]),_:1})]),default:l(()=>[r[11]||(r[11]=s(" Новый заказ ",-1))]),_:1}),t(e(P),{type:"primary",onClick:r[1]||(r[1]=h=>y.value=!0)},{icon:l(()=>[t(e(N),null,{default:l(()=>[t(e(J))]),_:1})]),default:l(()=>[r[12]||(r[12]=s(" Сдать инструмент ",-1))]),_:1})])]),t(e(V),{cols:4,"x-gap":16,"y-gap":16,class:"mb-6"},{default:l(()=>[t(e(w),null,{default:l(()=>[t(e(_),null,{default:l(()=>[a("div",Xe,[a("div",null,[t(e(k),{depth:"3"},{default:l(()=>[...r[13]||(r[13]=[s("Всего заказов",-1)])]),_:1}),t(D,{class:"m-0"},{default:l(()=>[s(f(e(v).totalOrders),1)]),_:1})]),t(e(N),{size:"32",color:"#2080f0"},{default:l(()=>[t(e(we))]),_:1})])]),_:1})]),_:1}),t(e(w),null,{default:l(()=>[t(e(_),null,{default:l(()=>[a("div",Ze,[a("div",null,[t(e(k),{depth:"3"},{default:l(()=>[...r[14]||(r[14]=[s("В обработке",-1)])]),_:1}),t(D,{class:"m-0"},{default:l(()=>[s(f(e(v).pendingOrders),1)]),_:1})]),t(e(N),{size:"32",color:"#f0a020"},{default:l(()=>[t(e(ue))]),_:1})])]),_:1})]),_:1}),t(e(w),null,{default:l(()=>[t(e(_),null,{default:l(()=>[a("div",We,[a("div",null,[t(e(k),{depth:"3"},{default:l(()=>[...r[15]||(r[15]=[s("Завершено",-1)])]),_:1}),t(D,{class:"m-0"},{default:l(()=>[s(f(e(v).completedOrders),1)]),_:1})]),t(e(N),{size:"32",color:"#18a058"},{default:l(()=>[t(e(ke))]),_:1})])]),_:1})]),_:1}),t(e(w),null,{default:l(()=>[t(e(_),null,{default:l(()=>[a("div",et,[a("div",null,[t(e(k),{depth:"3"},{default:l(()=>[...r[16]||(r[16]=[s("Выручка",-1)])]),_:1}),t(D,{class:"m-0"},{default:l(()=>[s(f(g(e(v).totalRevenue)),1)]),_:1})]),t(e(N),{size:"32",color:"#d03050"},{default:l(()=>[t(e(Ne))]),_:1})])]),_:1})]),_:1})]),_:1}),t(e(_),{class:"mb-6"},{default:l(()=>[a("div",tt,[t(e(H),{value:o.status,"onUpdate:value":r[2]||(r[2]=h=>o.status=h),placeholder:"Статус",options:S,clearable:"",style:{width:"200px"}},null,8,["value"]),t(e(H),{value:o.priority,"onUpdate:value":r[3]||(r[3]=h=>o.priority=h),placeholder:"Приоритет",options:F,clearable:"",style:{width:"200px"}},null,8,["value"]),t(e(re),{value:o.dateRange,"onUpdate:value":r[4]||(r[4]=h=>o.dateRange=h),type:"daterange",clearable:"",placeholder:"Период",style:{width:"250px"}},null,8,["value"]),t(e(T),{value:O.value,"onUpdate:value":r[5]||(r[5]=h=>O.value=h),placeholder:"Поиск по клиенту или номеру",clearable:"",style:{width:"300px"}},{prefix:l(()=>[t(e(N),null,{default:l(()=>[t(e(xe))]),_:1})]),_:1},8,["value"]),t(e(P),{onClick:d},{default:l(()=>[...r[17]||(r[17]=[s("Сбросить",-1)])]),_:1})])]),_:1}),t(e(_),null,{default:l(()=>[t(e(be),{columns:z,data:L.value,pagination:B,"row-key":h=>h.id,striped:""},null,8,["data","row-key"])]),_:1}),t(e(te),{show:y.value,"onUpdate:show":r[7]||(r[7]=h=>y.value=h),preset:"card",title:"Новый заказ",style:{width:"600px"}},{default:l(()=>[t(Fe,{onSubmit:c,onCancel:r[6]||(r[6]=h=>y.value=!1)})]),_:1},8,["show"]),t(e(te),{show:C.value,"onUpdate:show":r[8]||(r[8]=h=>C.value=h),preset:"card",title:"Детали заказа",style:{width:"800px"}},{default:l(()=>[q.value?(x(),E(Qe,{key:0,order:q.value},null,8,["order"])):K("",!0)]),_:1},8,["show"])])}}}),it=X(lt,[["__scopeId","data-v-56e47c34"]]);export{it as default};
